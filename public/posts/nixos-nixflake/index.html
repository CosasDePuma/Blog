<!doctype html><html lang=en-us><head><link rel=preload href=/Blog/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/Blog/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/Blog/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/Blog/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Learning how to use Nix Flakes | Kike! WTF?</title>
<link rel=canonical href=https://cosasdepuma.github.io/Blog/posts/nixos-nixflake/><meta name=description content="Welcome to my digital brain dump where I document my chaotic journey through the realms of hacking, devops, and whatever shiny tech catches my attention."><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:url" content="https://cosasdepuma.github.io/Blog/posts/nixos-nixflake/"><meta property="og:site_name" content="Kike! WTF?"><meta property="og:title" content="Learning how to use Nix Flakes"><meta property="og:description" content="Snowy Spellcraft Manual Hey there, fellow NixOS enthusiasts! Today I’m excited to guide you through the essentials of working with Nix Flakes. If you’ve been using Nix for a while but haven’t yet dipped your toes into the Flakes ecosystem, you’re in for a treat. Flakes bring reproducibility, composability, and improved usability to the already powerful Nix ecosystem.
Flakes are like magic spells for your development environment - once written, they work consistently for everyone, everywhere!"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-05-11T00:00:00+00:00"><meta property="article:modified_time" content="2025-05-11T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Learning how to use Nix Flakes"><meta name=twitter:description content="Snowy Spellcraft Manual Hey there, fellow NixOS enthusiasts! Today I’m excited to guide you through the essentials of working with Nix Flakes. If you’ve been using Nix for a while but haven’t yet dipped your toes into the Flakes ecosystem, you’re in for a treat. Flakes bring reproducibility, composability, and improved usability to the already powerful Nix ecosystem.
Flakes are like magic spells for your development environment - once written, they work consistently for everyone, everywhere!"><link rel=stylesheet href=https://cosasdepuma.github.io/Blog/css/styles.9111051a8d5b4f3dd25d69a174f68f689bd2a5a42e1a9954e34f2789540a1fbe459a5b2455be268a0d5c30669251a99c3c92020b5c91188d6a6ad92d6a11a833.css integrity="sha512-kREFGo1bTz3SXWmhdPaPaJvSpaQuGplU408niVQKH75FmlskVb4mig1cMGaSUamcPJICC1yRGI1qatktahGoMw=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://cosasdepuma.github.io/Blog/images/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/Blog/>Home</a></li><li><a href=/Blog/posts>Writings</a></li><li><a href=/Blog/categories>Categories</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://cosasdepuma.github.io/Blog/posts/hacking-rootsofpacha/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fcosasdepuma.github.io%2fBlog%2fposts%2fnixos-nixflake%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fcosasdepuma.github.io%2fBlog%2fposts%2fnixos-nixflake%2f&text=Learning%20how%20to%20use%20Nix%20Flakes" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fcosasdepuma.github.io%2fBlog%2fposts%2fnixos-nixflake%2f&title=Learning%20how%20to%20use%20Nix%20Flakes" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fcosasdepuma.github.io%2fBlog%2fposts%2fnixos-nixflake%2f&is_video=false&description=Learning%20how%20to%20use%20Nix%20Flakes" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Learning%20how%20to%20use%20Nix%20Flakes&body=Check out this article: https%3a%2f%2fcosasdepuma.github.io%2fBlog%2fposts%2fnixos-nixflake%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fcosasdepuma.github.io%2fBlog%2fposts%2fnixos-nixflake%2f&title=Learning%20how%20to%20use%20Nix%20Flakes" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fcosasdepuma.github.io%2fBlog%2fposts%2fnixos-nixflake%2f&title=Learning%20how%20to%20use%20Nix%20Flakes" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fcosasdepuma.github.io%2fBlog%2fposts%2fnixos-nixflake%2f&name=Learning%20how%20to%20use%20Nix%20Flakes&description=%3ch1%20id%3d%22snowy-spellcraft-manual%22%3eSnowy%20Spellcraft%20Manual%3c%2fh1%3e%0a%3cp%3eHey%20there%2c%20fellow%20NixOS%20enthusiasts%21%20Today%20I%26rsquo%3bm%20excited%20to%20guide%20you%20through%20the%20essentials%20of%20working%20with%20Nix%20Flakes.%20If%20you%26rsquo%3bve%20been%20using%20Nix%20for%20a%20while%20but%20haven%26rsquo%3bt%20yet%20dipped%20your%20toes%20into%20the%20Flakes%20ecosystem%2c%20you%26rsquo%3bre%20in%20for%20a%20treat.%20Flakes%20bring%20reproducibility%2c%20composability%2c%20and%20improved%20usability%20to%20the%20already%20powerful%20Nix%20ecosystem.%3c%2fp%3e%0a%3cblockquote%3e%0a%3cp%3eFlakes%20are%20like%20%3cstrong%3emagic%20spells%3c%2fstrong%3e%20for%20your%20development%20environment%20-%20once%20written%2c%20they%20work%20consistently%20for%20everyone%2c%20everywhere%21%3c%2fp%3e" aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fcosasdepuma.github.io%2fBlog%2fposts%2fnixos-nixflake%2f&t=Learning%20how%20to%20use%20Nix%20Flakes" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#what-are-flakes->What are Flakes? ⛄️</a></li><li><a href=#basic-flake-structure->Basic Flake Structure 📁</a></li><li><a href=#checking-what-a-flake-provides->Checking what a Flake provides 👀</a></li><li><a href=#pinning-dependencies->Pinning dependencies 📌</a></li><li><a href=#building-and-running-packages->Building and running packages 📦</a></li><li><a href=#using-development-environments->Using development environments 🛠️</a><ul><li><a href=#managing-nixos-with-flakes->Managing NixOS with Flakes 🖥️</a></li></ul></li><li><a href=#advanced-usage-tips->Advanced Usage Tips 🧙‍♂️</a></li><li><a href=#creating-your-own-flakes->Creating Your Own Flakes 📝</a></li><li><a href=#resources->Resources 📚</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Learning how to use Nix Flakes</h1><div class=meta><div class=postdate><time datetime="2025-05-11 00:00:00 +0000 UTC" itemprop=datePublished>2025-05-11</time>
&nbsp;</div><div class=article-read-time>&nbsp;
<i class="far fa-clock"></i>
5 minute read
&nbsp;</div><div class=article-category>&nbsp;
<i class="fas fa-archive"></i>
<a class=category-link href=/categories/automation>automation</a>
,
<a class=category-link href=/categories/homelab>homelab</a>
,
<a class=category-link href=/categories/nix>nix</a>
,
<a class=category-link href=/categories/nixos>nixos</a></div></div></header><div class=content itemprop=articleBody><h1 id=snowy-spellcraft-manual>Snowy Spellcraft Manual</h1><p>Hey there, fellow NixOS enthusiasts! Today I&rsquo;m excited to guide you through the essentials of working with Nix Flakes. If you&rsquo;ve been using Nix for a while but haven&rsquo;t yet dipped your toes into the Flakes ecosystem, you&rsquo;re in for a treat. Flakes bring reproducibility, composability, and improved usability to the already powerful Nix ecosystem.</p><blockquote><p>Flakes are like <strong>magic spells</strong> for your development environment - once written, they work consistently for everyone, everywhere!</p></blockquote><p>I&rsquo;ve been using NixOS for the past few years, and switching to Flakes has been a game-changer for managing my configurations across different machines. Let me share what I&rsquo;ve learned along the way!</p><h2 id=what-are-flakes->What are Flakes? ⛄️</h2><p>In essence, Flakes are a way to package Nix code with strict dependencies, making it more reproducible and shareable. They solve several pain points in the Nix ecosystem:</p><ul><li><strong>Reproducibility</strong>: Flakes lock all dependencies, ensuring the same build across different machines</li><li><strong>Composability</strong>: Easily incorporate other flakes into your own</li><li><strong>Discoverability</strong>: Standard structure makes it clear what a Flake provides</li><li><strong>Usability</strong>: Consistent CLI interface for all Flakes</li></ul><p>Before we dive into creating our first Flake, make sure you have Nix installed with Flakes enabled. If you&rsquo;re using NixOS, add this to your configuration:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>nix<span style=color:#ff79c6>.</span>extraOptions <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;experimental-features = nix-command flakes&#34;</span>;
</span></span></code></pre></div><p>For non-NixOS users, you can add this to your <code>~/.config/nix/nix.conf</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>experimental-features <span style=color:#ff79c6>=</span> nix-command flakes
</span></span></code></pre></div><h2 id=basic-flake-structure->Basic Flake Structure 📁</h2><p>Every Flake revolves around a <code>flake.nix</code> file at the root of your project. Here&rsquo;s the simplest possible Flake:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>{
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>  description <span style=color:#ff79c6>=</span> <span style=color:#f1fa8c>&#34;My first Nix Flake&#34;</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>  
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>  inputs <span style=color:#ff79c6>=</span> {};
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>  
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>  outputs <span style=color:#ff79c6>=</span> { self }: {};
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>}
</span></span></code></pre></div><p>That&rsquo;s it! This is a valid (but empty) Flake. Let&rsquo;s break down these three essential components:</p><ol><li><strong>description</strong>: A human-readable description of your Flake</li><li><strong>inputs</strong>: External dependencies your Flake needs</li><li><strong>outputs</strong>: What your Flake provides to the world</li></ol><p>Now that we understand what Flakes are, let&rsquo;s explore how to interact with them using the <code>nix flake</code> command. Whether you&rsquo;re using someone else&rsquo;s Flake or your own, these commands will become part of your daily workflow.</p><p>For example, it is possible to initialize a basic flake using the <code>nix flake init</code> command.</p><h2 id=checking-what-a-flake-provides->Checking what a Flake provides 👀</h2><p>The <code>show</code> command gives you a quick overview of what a Flake offers:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#6272a4># Show outputs from a local flake</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>nix flake show
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span><span style=color:#6272a4># Show outputs from a remote flake</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>nix flake show github:nixos/nixpkgs/nixos-unstable
</span></span></code></pre></div><p>This is incredibly useful to discover what packages, NixOS modules, or development environments a Flake provides. The output might look something like this:</p><pre tabindex=0><code>github:NixOS/nixpkgs/nixos-unstable
├───checks
│   ├───x86_64-linux
│   │  └───...
├───devShells
│   ├───aarch64-darwin
│   │   └───default: development environment &#39;nix-shell&#39;
├───packages
│   └───x86_64-linux
│   │  └───...
</code></pre><p>As you can see, this specific Flake provides checks, development shells, programs, and more.</p><p>We will leave for another time what each of these categories is, but the output highlights the structured and organized nature of Flakes, making it easier to identify and utilize the resources they provide.</p><h2 id=pinning-dependencies->Pinning dependencies 📌</h2><p>Flakes use a <code>flake.lock</code> file to pin dependencies to specific versions. When you first use a Flake, this file is created automatically.</p><p>It is also possible to force this behavior using the following commands:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#6272a4># Initialize or update lock file</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>nix flake lock
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span><span style=color:#6272a4># Update all inputs to their latest versions</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>nix flake update
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span><span style=color:#6272a4># Update only specific inputs</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span>nix flake update nixpkgs
</span></span></code></pre></div><p>The lock file is what makes Flakes so reproducible. Even if you run <code>nix flake</code> commands months apart, you&rsquo;ll get the exact same results as long as the lock file remains unchanged.</p><h2 id=building-and-running-packages->Building and running packages 📦</h2><p>In the context of a Flake, <code>packages</code> are software artifacts that can be built or executed.</p><p>Flakes provide a standardized way to define, build, and run packages across different systems. These packages are self-contained with all their dependencies specified, ensuring they work the same way regardless of where they&rsquo;re used.</p><p>Packages are defined under the <code>outputs.packages.&lt;system>.&lt;name></code> attribute. If a Flake provides <code>packages</code>, you can build and run them with:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#6272a4># Build the default package provided by the local flake</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>nix build
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#6272a4># Build a specific package provided by the local flake</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>nix build .#name
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#6272a4># Build a package provided by a remote flake</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>nix build github:nixos/nixpkgs/nixos-unstable#cowsay
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span><span style=color:#6272a4># Run the previous built package</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>./result/bin/&lt;package&gt;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span><span style=color:#6272a4># Run the default package provided by the flake</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>nix run
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span><span style=color:#6272a4># Run a specific package provided by the flake</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>nix run .#name
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#6272a4># Run a package provided by a remote flake</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>nix run github:nixos/nixpkgs/nixos-unstable#cowsay
</span></span></code></pre></div><h2 id=using-development-environments->Using development environments 🛠️</h2><p>A <code>devShell</code> in the context of Nix Flakes is a declarative development environment.</p><p>It allows you to define all the tools, dependencies, and environment variables needed for a project in a reproducible way. This ensures that every developer working on the project has the exact same environment, avoiding &ldquo;it works on my machine&rdquo; issues.</p><p>Development shells are defined under the <code>outputs.devShells.&lt;system>.&lt;name></code> value. If a Flake provides <code>devShells</code>, you can use them with:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#6272a4># Enter the default shell provided by the local flake</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>nix develop
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span><span style=color:#6272a4># Enter a specific shell provided by the local flake</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>nix develop .#name
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span><span style=color:#6272a4># Enter a shell provided by a remote flake</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span>nix develop github:nixos/nixpkgs/nixos-unstable#default
</span></span></code></pre></div><h3 id=managing-nixos-with-flakes->Managing NixOS with Flakes 🖥️</h3><p>For NixOS users, Flakes offer a powerful way to manage system configurations:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#6272a4># Switch to a system configuration defined in a flake</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>sudo nixos-rebuild switch --flake .#my-laptop
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span><span style=color:#6272a4># Build but don&#39;t activate a configuration</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>sudo nixos-rebuild build --flake .#my-laptop
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span><span style=color:#6272a4># Test a configuration in a VM</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span>sudo nixos-rebuild build-vm --flake .#my-laptop
</span></span></code></pre></div><h2 id=advanced-usage-tips->Advanced Usage Tips 🧙‍♂️</h2><p>Here are some advanced tips for working with Flakes:</p><ol><li><strong>Registry shortcuts</strong>: Add frequently used Flakes to your registry with <code>nix registry add my-flake github:user/repo</code></li><li><strong>Flake references</strong>: Use flake references like <code>nixpkgs#output</code> to directly refer to outputs.</li><li><strong>Evaluating attributes</strong>: Use <code>nix eval</code> to inspect specific attributes of a Flake package, as the version.</li><li><strong>Temporary overrides</strong>: Use <code>--override-input</code> to temporarily use a different version of a dependency</li></ol><p>For example, to temporarily use a different input:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>nix build --override-input nixpkgs github:NixOS/nixpkgs/nixos-22.11
</span></span></code></pre></div><h2 id=creating-your-own-flakes->Creating Your Own Flakes 📝</h2><p>While I&rsquo;ve focused on how to use Flakes here, creating your own Flakes is a topic that deserves its own dedicated posts. If you&rsquo;re interested in learning more about writing your own Flakes, check out these upcoming articles:</p><ul><li><a href=/posts/flake-dev-environments>Creating Development Environment Flakes</a> (coming soon)</li><li><a href=/posts/flake-packages>Building Packages with Flakes</a> (coming soon)</li><li><a href=/posts/flake-nixos-config>Managing NixOS Configurations with Flakes</a> (coming soon)</li><li><a href=/posts/advanced-flakes>Advanced Flake Techniques</a> (coming soon)</li></ul><h2 id=resources->Resources 📚</h2><p>Here are some fantastic resources that helped me understand Flakes:</p><ul><li><a href=https://nixos.wiki/wiki/Flakes>Nix Flakes Wiki</a></li><li><a href=https://zero-to-nix.com/>Zero to Nix</a></li><li><a href=https://nixos.wiki/wiki/Flakes#Flake_schema>Flake Schema Reference</a></li><li><a href=https://serokell.io/blog/practical-nix-flakes>Practical Nix Flakes</a></li></ul><p>Happy Flaking! 🎉</p></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/Blog/>Home</a></li><li><a href=/Blog/posts>Writings</a></li><li><a href=/Blog/categories>Categories</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#what-are-flakes->What are Flakes? ⛄️</a></li><li><a href=#basic-flake-structure->Basic Flake Structure 📁</a></li><li><a href=#checking-what-a-flake-provides->Checking what a Flake provides 👀</a></li><li><a href=#pinning-dependencies->Pinning dependencies 📌</a></li><li><a href=#building-and-running-packages->Building and running packages 📦</a></li><li><a href=#using-development-environments->Using development environments 🛠️</a><ul><li><a href=#managing-nixos-with-flakes->Managing NixOS with Flakes 🖥️</a></li></ul></li><li><a href=#advanced-usage-tips->Advanced Usage Tips 🧙‍♂️</a></li><li><a href=#creating-your-own-flakes->Creating Your Own Flakes 📝</a></li><li><a href=#resources->Resources 📚</a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fcosasdepuma.github.io%2fBlog%2fposts%2fnixos-nixflake%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fcosasdepuma.github.io%2fBlog%2fposts%2fnixos-nixflake%2f&text=Learning%20how%20to%20use%20Nix%20Flakes" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fcosasdepuma.github.io%2fBlog%2fposts%2fnixos-nixflake%2f&title=Learning%20how%20to%20use%20Nix%20Flakes" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fcosasdepuma.github.io%2fBlog%2fposts%2fnixos-nixflake%2f&is_video=false&description=Learning%20how%20to%20use%20Nix%20Flakes" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Learning%20how%20to%20use%20Nix%20Flakes&body=Check out this article: https%3a%2f%2fcosasdepuma.github.io%2fBlog%2fposts%2fnixos-nixflake%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fcosasdepuma.github.io%2fBlog%2fposts%2fnixos-nixflake%2f&title=Learning%20how%20to%20use%20Nix%20Flakes" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fcosasdepuma.github.io%2fBlog%2fposts%2fnixos-nixflake%2f&title=Learning%20how%20to%20use%20Nix%20Flakes" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fcosasdepuma.github.io%2fBlog%2fposts%2fnixos-nixflake%2f&name=Learning%20how%20to%20use%20Nix%20Flakes&description=%3ch1%20id%3d%22snowy-spellcraft-manual%22%3eSnowy%20Spellcraft%20Manual%3c%2fh1%3e%0a%3cp%3eHey%20there%2c%20fellow%20NixOS%20enthusiasts%21%20Today%20I%26rsquo%3bm%20excited%20to%20guide%20you%20through%20the%20essentials%20of%20working%20with%20Nix%20Flakes.%20If%20you%26rsquo%3bve%20been%20using%20Nix%20for%20a%20while%20but%20haven%26rsquo%3bt%20yet%20dipped%20your%20toes%20into%20the%20Flakes%20ecosystem%2c%20you%26rsquo%3bre%20in%20for%20a%20treat.%20Flakes%20bring%20reproducibility%2c%20composability%2c%20and%20improved%20usability%20to%20the%20already%20powerful%20Nix%20ecosystem.%3c%2fp%3e%0a%3cblockquote%3e%0a%3cp%3eFlakes%20are%20like%20%3cstrong%3emagic%20spells%3c%2fstrong%3e%20for%20your%20development%20environment%20-%20once%20written%2c%20they%20work%20consistently%20for%20everyone%2c%20everywhere%21%3c%2fp%3e" aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fcosasdepuma.github.io%2fBlog%2fposts%2fnixos-nixflake%2f&t=Learning%20how%20to%20use%20Nix%20Flakes" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2025 Kike! WTF?</div><div class=footer-right><nav><ul><li><a href=/Blog/>Home</a></li><li><a href=/Blog/posts>Writings</a></li><li><a href=/Blog/categories>Categories</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script><script src=/Blog/js/code-copy.js></script></html>